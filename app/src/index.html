<!DOCTYPE html>
<html>
  <head>
    <title>A Classic Game</title>
    <meta name="viewport" content="width=device-width, initial-scale=1">

	<!-- Bootstrap Files -->
	<link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

	<!-- Page CSS -->
  <!-- <link rel="stylesheet" href="css/page.css" type="text/css"> -->
  <link rel="stylesheet" href="https://pro.fontawesome.com/releases/v5.10.0/css/all.css" integrity="sha384-AYmEC3Yw5cVb3ZcuHtOA93w35dYTsvhLPVnYs9eStHfGJvOvKxVfELGroGkvsg+p" crossorigin="anonymous"/>
  </head> 
  <body>
    <div style="margin-left: 10px;"">
      <!-- contract balance  and  status -->
      <section>
        <div class="row bg-light statusBar">
          <div class="col-sm-6">
            <span class="badge badge-pill badge-transparent statusText">Contract Balance: 
              <span id ="contractBalance"></span>
            </span>
            <span class="badge badge-pill badge-transparent statusText">Contract Status:
              <span id ="contractStatus"></span>            
            </span>
          </div>                   
        </div>
      </section>     
      
      <!-- active address selection -->
      <section>
        <div class="d-inline">          
          <span id="activeWallet" style="font-size:xx-large;font-weight:900;margin-left:10px"></span>
          <span id="winningsAmount" class="col-md-2 alert alert-info" style="font-size:xx-large;font-weight:700;margin-left:10px" role="alert"></span>
          <button class="btn btn-lg btn-info" data-toggle="modal" data-target="#payoutModal"><i class="fas fa-coins"></i>&nbsp PAYOUT</button>
        </div>
        <hr/>
        <div class="d-inline">
          <select id="addressSelector" name="Addresses" style="font-size:large;font-weight:500;margin-left:10px"  onchange="App.setActiveWallet(this.option)"></select>          
        </div>
        <hr/>
      </section>  

        <!-- Tx status, progress bar -->
        <section class="row bg-light" style="align-content:center;" id="statusSection">
          <div class="col-sm-8 col-md-8">
            <div class="progress" style="height: 20px;">
              <div class="progress-bar" id="txStatusProgressbar" role="progressbar" aria-valuenow="25" aria-valuemin="0" aria-valuemax="100"></div>
            </div>
            </div>
          <div class="col-sm-8 mt-2 mb-2" style="align-items: center;">
            <div id="txStatus" class="alert alert-success" role="alert">            
            </div>
          </div>
        </section>  
        <br/>

      <!-- game list -->
      <br/>
      <section id="games" class="col-md-12" style="width: 100%;margin-left: 10px;">
        <div style="display:inline-block">
          <button class="btn btn-lg btn-primary" id="btnGamesRefresh" onclick="App.refreshGames()"><i class="fas fa-sync"></i> &nbsp Refresh Games</a></button>           
          <button class="btn btn-lg btn-success" data-toggle="modal" data-target="#createModal"><i class="fas fa-magic"></i> &nbsp Create </button>
          
        </div>   
        <br/>
        <hr/>
        <div id="noGamesBanner" class="col-md-6 alert alert-info" role="alert">          
        </div>
        <div id="gamesTableContainer" class="col-md-12" >
          <table id ="gamesTable" class="table table-striped table-sm gametable">
            <thead>
              <tr>
                <th scope="col">Id</th>
                <th scope="col">Status</th>
                <th scope="col">Player 1</th>
                <th scope="col">Player 2</th>
                <th scope="col">Staked</th>
                <th scope="col">Expires</th>                
                <th scope="col"></th>  
              </tr>
            </thead>
            <tbody id="gamesTableData" class="small">            
            </tbody>
          </table>
        </div>
      </section>
      <br/>
      <hr/>
      <br/>
    </div>

      <!----Modals        Modals        Modals        Modals      Modals  -->

      <!-- create Modal -->
      <div class="modal fade" id="createModal" tabindex="-1" role="dialog" aria-labelledby="createModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="createModalLabel">Create Game</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <input type="text" class="form-control" id="create_counterparty" aria-placeholder="Opponent" placeholder="Opponent address" required>
                <small class="form-text text-danger" id ="create_counterparty_Error"></small>
              </div>
    
              <div class="form-group">
                <input type="number" class="form-control" min="0" id="create_stake" aria-placeholder="Ether to stake" placeholder="Ether to stake">
                <small class="form-text text-info" id ="create_min_stake_message">Minimum Stake</small>
                <small class="form-text text-danger" id ="create_stake_Error"></small>                    
              </div>       
              
              <div class="form-group">
                <input type="text" class="form-control" id="create_mask" minlength="15" aria-placeholder="Mask string" placeholder="Mask string">
                <small class="form-text text-danger" id ="create_mask_Error"></small>
              </div>  

              <div class="btn-group mb-2 " role="group" aria-label="Choices" id="create_choices">
                <button id="create_rock" type="button" class="btn btn-lg btn-secondary rpsChoice"  value="1" onclick="App.choiceSelected(id)">
                  <i class="fas fa-3x fa-hand-rock"></i>
                </button>
                <button id="create_paper" type="button" class="btn btn-lg btn-secondary rpsChoice" value="2" onclick="App.choiceSelected(id)">
                  <i class="fas fa-3x fa-hand-paper"></i>
                </button>
                <button id="create_scissors" type="button" class="btn btn-lg btn-secondary rpsChoice" value="3" onclick="App.choiceSelected(id)">
                  <i class="fas fa-3x fa-hand-scissors"></i>
                </button>            
              </div> 
              <hidden id="create_chosen"></hidden>  
              <br>      
              <div><small class="form-text text-info" id ="create_gameLength_limits">Minimum Maximum Lifetime</small></div>
              <div class="input-group" id="gameLengthGroup">                      
                <div class="input-group-prepend">
                  <span class="input-group-text"><i class="fas fa-hourglass-end"></i> &nbsp Expires In</span>
                </div>
                
                  <input type="number" aria-label="days" max="365" min="0" placeholder= "000" id="create_gameDays" value="0" class="form-control input-sm">
                  <span class="input-group-text">days</span>              
                  <input type="number" aria-label="hours" max="24" min="0" placeholder="00" id="create_gameHours" value="24" class="form-control input-sm">
                  <span class="input-group-text">hrs</span>
                  <input type="number" aria-label="hours" max="60" min="0" placeholder="00" id="create_gameMinutes" value="0" class="form-control input-sm">
                  <span class="input-group-text">mins</span>
                  <small class="form-text text-danger" id ="create_gameLength_Error"></small>
              </div>
              <br>           
              <small class="form-text text-danger" id ="create_chosen_Error"></small>  
              <div>
                <button class="btn btn-lg btn-block btn-success" id="btnCreate" data-dismiss="modal" onclick="App.create()"><i class="fas fa-magic"></i> &nbsp Create</a> 
              </div>
            </div>
          </div>
        </div>
      </div>   

        <!-- enrol Modal -->
      <div class="modal fade" id="enrolModal" tabindex="-1" role="dialog" aria-labelledby="enrolModalLabel" aria-hidden="true">
          <div class="modal-dialog modal-dialog-centered" role="document">
            <div class="modal-content">
              <div class="modal-header">
                <h5 class="modal-title" id="enrolModalLabel"></h5>
                <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                  <span aria-hidden="true">&times;</span>
                </button>
              </div>
              <div class="modal-body">
                <section id="enrolGame">
                  <hidden id="enrol_gameId"/> 
                  <hidden id="enrol_deadline"/>              
                  <div>
                    <small class="form-text text-danger" id ="enrol_deadline_Error"></small>
                  </div>                
                  <div class="form-group">
                    <input type="text" class="form-control" id="enrol_mask" aria-placeholder="Mask string" placeholder="Mask string" required>
                    <small class="form-text text-danger" id ="enrol_mask_Error"></small>
                  </div>
                  <div class="form-group">
                    <input type="number" class="form-control" min="0" id="enrol_stake" aria-placeholder="To Stake" disabled placeholder="To Stake" required>
                    <small class="form-text text-danger" id ="enrol_stake_Error"></small>
                  </div> 
                  <div class="btn-group mb-2 rpsChoice" role="group" aria-label="Choices" id="enrol_choices">
                    <button id="enrol_rock" type="button" class="btn btn-lg btn-secondary rpsChoice"  value="1" onclick="App.enrolChoiceSelected(id)">
                      <i class="fas fa-3x fa-hand-rock" ></i>
                    </button>
                    <button id="enrol_paper" type="button" class="btn btn-lg btn-secondary rpsChoice" value="2" onclick="App.enrolChoiceSelected(id)">
                      <i class="fas fa-3x fa-hand-paper"></i>
                    </button>
                    <button id="enrol_scissors" type="button" class="btn btn-lg btn-secondary rpsChoice" value="3" onclick="App.enrolChoiceSelected(id)">
                      <i class="fas fa-3x fa-hand-scissors"></i>
                    </button>            
                  </div> 
                  <hidden id="enrol_chosen" required></hidden>             
                  <small class="form-text text-danger" id ="enrol_chosen_Error"></small> 
                  
                  <button class="btn btn-lg btn-block btn-success" id="btnEnrol" data-dismiss="modal" onclick="App.enrol()"><i class="fas fa-sign-in-alt"></i> &nbsp Enrol</a>   
                </section>
              </div>
            </div>
          </div>
      </div>

      <!-- reveal Modal -->
      <div class="modal fade" id="revealModal" tabindex="-1" role="dialog" aria-labelledby="revealModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="revealModalLabel"></h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <div id="revealGame" style="align-self:center;">
                <hidden id="reveal_gameId"/> 
                <hidden id="reveal_deadline"/>
                <hidden id="reveal_revealer"/>
                <hidden id="reveal_yourchoice"/>
                <hidden id="reveal_theirchoice"/>
                <div>
                  <small class="form-text text-danger" id ="reveal_deadline_Error"></small>
                </div>   
                <table id ="gamesTable" class="table borderless">
                  <thead>
                    <tr>
                      <th scope="col">Yours</th>
                      <th scope="col">Theirs</th>
                      <th scope="col">Outcome</th>                
                    </tr>
                  </thead>
                  <tbody>
                    <tr>
                      <td id="reveal_yourchoice_html"></td>
                      <td id="reveal_theirchoice_html"></td>
                      <td id="reveal_outcome_html" ></td>
                    </tr>
                  </tbody>
                </table>
              </div>
              <div>
                <button class="btn btn-block btn-lg btn-success" id="btnReveal" data-dismiss="modal" onclick="App.reveal()">                  
                  <i class="fas fa-eye"></i> &nbsp Reveal</a></button> 
              </div>
              </div>                        
          </div>
        </div>
      </div>

      <!-- settle Modal -->
      <div class="modal fade" id="settleModal" tabindex="-1" role="dialog" aria-labelledby="settleModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="settleModalLabel">settle Winnings</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <div class="form-group">
                <input type="text" class="form-control" id="settle_gameId" aria-placeholder="game Id" placeholder="game Id" required>
                <small class="form-text text-danger" id ="settle_gameId_Error"></small>
              </div>
              <button class="btn btn-lg btn-block btn-success" id="btnSettle" onclick="App.settle()"><i class="fas fa-gavel"></i> &nbsp Settle</a> 
            </div>                
          </div>
        </div>
      </div>
    </div>


      <!-- payout modal -->      
      <div class="modal fade" id="payoutModal" tabindex="-1" role="dialog" aria-labelledby="payoutModalLabel" aria-hidden="true">
        <div class="modal-dialog modal-dialog-centered" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="payoutModalLabel">Payout Winnings</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              <div class="form-group">                
                <span id="payout_balance" class="alert alert-success" role="alert"></span>
              </div>
              <div>
                <button class="btn btn-lg btn-block btn-success" id="btnPayout" data-dismiss="modal" onclick="App.payout()"><i class="fas fa-coins"></i> &nbsp Payout</a>                 
              </div>
            </div>            
          </div>
        </div>
      </div>
    </div>

    <!-- Bootstrap Files -->
    <script src="https://code.jquery.com/jquery-3.3.1.slim.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/popper.js/1.14.7/umd/popper.min.js"></script>
    <script src="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/js/bootstrap.min.js"></script>
    <!-- Page JS -->
    <script src="index.js"></script>

    <style>
      .rpsChoice {
        border-style: solid 2px;
        border-color: black;
        width: 100px;
        height: 100px;
      }
      .statusText {
        margin-bottom: 10px;
        margin-top: 10px;
        padding: 10px 10px;
        font-size: large;
        align-self: center;
      }
      input[type="checkbox"] {
        scale: 0.6;
      }
      label {
        display: inline-block;
      }      
      select.form-control.fa option{ font-weight: 900; }
      
      .borderless td, .borderless th {
        border: none;
      }
      .gametable td,tr {
        font-weight:bold;
        font-size: large;
      }
    </style>
  </body>
</html>
